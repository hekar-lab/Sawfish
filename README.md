# Sawfish

## Disclaimer

This project isn't working.  
It stays here to document the work that was done and its failures. In doing
so we hope to help future projects avoid the same fate.

## Initial goal of the project

Builds the necessary SLEIGH files (`.slaspec`, `.pspec`, `.cspec`)
for the [Ghidra-BlackfinPlus](https://github.com/hekar-lab/Ghidra-BlackFinPlus) plugin.

## Where it failed

Ghidra has a limit on large `.sla` file[^1] can be. That limit of 16 MiB is stored
by the `MAX_FILE_SIZE` constant in the `SlaFormat` class. Our project generate a
large quantity of SLEIGH constructors[^2] due to the naive approach we took to generate
the files. This makes it so once compiled the size of the `.sla` file is around
2.8 MB. Which is well below the `MAX_FILE_SIZE` limit. But this limit isn't based
on the output of the SLEIGH compiler but on the **uncompressed** of said output.
Once decompressed by the `InflaterInputStream` class the resulting data is around
24.8 MB, and thus gets truncated by the decoder which inevitably creates a parsing
issue of some kind.

It is of course possible to make it work by increasing said limit. But our sentiment
is that if it has to come to this our initial approach must be flawed. That being
said, if you wish to try out Ghidra-BlackfinPlus plugin with the buggy Sawfish
files, you can find it on the 
[Sawfish branch of the Ghidra-BlackfinPlus project](https://github.com/hekar-lab/Ghidra-BlackFinPlus/tree/sawfish).
You will have to build your own modified version of Ghidra with a higher `MAX_FILE_SIZE`
if you want to run it.

[^1]: File generated by the SLEIGH compiler
[^2]: Units that define as set of processor instructions. In our case those sets were pretty small.